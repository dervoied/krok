$.fn.scrollPane=function(a){function r(r){r=r||window.event;var t=r.deltaY||r.detail||-1*r.wheelDelta/40,e=!1;"vertical"==a.type||"auto"==a.type?(this.arData.areaMarginY-=a.delta*t,e=this.func.scrollAreaTo(this,this.arData.areaMarginY,"Y",!1)):e=!0,e||(r.preventDefault?r.preventDefault():r.returnValue=!1),r.stopPropagation()}var t=this;return t.length?(a=$.extend({"container-max-height":!1,"container-max-width":!1,"container-height":!1,"container-width":!1,"track-y-min-height":20,"track-x-min-width":20,"track-y-height":!1,"track-x-width":!1,"scroll-bottom":!1,arrow:!0,type:"auto",delta:5,"scroll-to-x":0,"scroll-to-y":0,"animate-time":300},a||{}),void t.each(function(t){if($(this).hasClass("scrollpane-area")){var e=this,n=$(this).find("img");n.length?$.when(indi.utils.preloadImage(n)).done(function(){e.func.trackSize(e),e.func.scrollAreaTo(e,a["scroll-to-x"],"X",!1,0),e.func.scrollAreaTo(e,a["scroll-to-y"],"Y",!1,0)}):(e.func.trackSize(e),e.func.scrollAreaTo(e,a["scroll-to-x"],"X",!1,0),e.func.scrollAreaTo(e,a["scroll-to-y"],"Y",!1,0))}else{var e=this;e.arObj={},e.arData={},e.func={},e.func.preloadImage=function(a){if(a instanceof jQuery){var r=[];return a.each(function(){$(this).is("img")?r.push($(this).attr("src")):$(this).is("a")&&r.push($(this).attr("href"))}),this.preloadImage(r)}a instanceof Array||(a=[a]);for(var t=$.Deferred(),e={},n=0,i=0;i<a.length;i++){var o=a[i],c="id"+o.replace(/[^A-z0-9]/g,"");void 0===e[c]&&(e[c]={image:new Image,url:o},n++)}var l=0;for(var c in e)e[c].image.onload=function(){++l>=n&&t.resolve()},e[c].image.src=e[c].url;return t.promise()},e.func.trackSize=function(r){r.arObj.container.addClass("scrollpane-load"),r.arObj.containerGlobal.removeClass("scroll-x"),r.arObj.containerGlobal.removeClass("scroll-y"),r.arData.containerGlobalLeft=1*r.arObj.containerGlobal.offset().left,r.arData.containerGlobalWidth=1*r.arObj.containerGlobal.width(),r.arData.containerGlobalHeight=1*r.arObj.containerGlobal.height(),r.arData.areaWidth=r.arObj.area.outerWidth();var t=!1;("horizontal"==a.type||"auto"==a.type)&&r.arData.areaWidth>r.arData.containerGlobalWidth&&(r.arObj.containerGlobal.addClass("scroll-x"),r.arData.lineXLeft=1*r.arObj.lineX.css("left").replace("px",""),t=!0),r.arData.containerHeight=r.arData.containerGlobalHeight-1*r.arObj.container.css("margin-bottom").replace("px",""),r.arData.areaHeight=r.arObj.area.outerHeight();var n=!1;r.arData.barXHeight=0,("vertical"==a.type||"auto"==a.type)&&r.arData.areaHeight>r.arData.containerGlobalHeight&&(r.arObj.containerGlobal.addClass("scroll-y"),r.arData.barXHeight=1*r.arObj.barX.height(),r.arData.lineYTop=1*r.arObj.lineY.css("top").replace("px",""),n=!0,r.arData.areaHeight=r.arObj.area.outerHeight()),r.arData.containerWidth=r.arData.containerGlobalWidth-1*r.arObj.container.css("margin-right").replace("px","");t?(r.arData.lineXWidth=r.arObj.lineX.outerWidth(),r.arData.trackXWidth=r.arData.lineXWidth*r.arData.containerWidth/r.arData.areaWidth,a["track-x-width"]?r.arData.trackXWidth=a["track-x-width"]:r.arData.trackXWidth<a["track-x-min-width"]&&(r.arData.trackXWidth=a["track-x-min-width"]),r.arObj.trackX.css({width:r.arData.trackXWidth+"px"})):(r.arObj.area.css({"margin-left":0,"margin-right":0}),r.arObj.trackX.css({"margin-left":e.arData.lineXLeft})),n?(r.arData.lineYHeight=r.arObj.lineY.outerHeight(),r.arData.trackYHeight=r.arData.lineYHeight*r.arData.containerHeight/r.arData.areaHeight,a["track-y-height"]?r.arData.trackYHeight=a["track-y-height"]:r.arData.trackYHeight<a["track-y-min-height"]&&(r.arData.trackYHeight=a["track-y-min-height"]),r.arObj.trackY.css({height:r.arData.trackYHeight+"px"})):(r.arObj.area.css({"margin-top":0,"margin-bottom":0}),r.arObj.trackY.css({"margin-top":e.arData.lineYTop})),r.arObj.area.data("width")?r.arObj.container.css({width:r.arObj.area.data("width")-1*r.arObj.container.css("margin-right").replace("px","")+"px","max-width":"none"}):r.arObj.area.data("max-width")?r.arObj.container.css({width:"auto","max-width":r.arObj.area.data("max-width")-1*r.arObj.container.css("margin-right").replace("px","")+"px"}):a["container-width"]?r.arObj.container.css({width:a["container-width"]-1*r.arObj.container.css("margin-right").replace("px","")+"px","max-width":"none"}):a["container-max-width"]?r.arObj.container.css({width:"auto","max-width":a["container-max-width"]-1*r.arObj.container.css("margin-right").replace("px","")+"px"}):r.arObj.container.css({width:"auto","max-width":"none"}),r.arObj.area.data("height")?r.arObj.container.css({height:r.arObj.area.data("height")-1*r.arObj.container.css("margin-bottom").replace("px","")+"px","max-height":"none"}):r.arObj.area.data("max-height")?r.arObj.container.css({height:"auto","max-height":r.arObj.area.data("max-height")-1*r.arObj.container.css("margin-bottom").replace("px","")+"px"}):a["container-height"]?r.arObj.container.css({height:a["container-height"]-1*r.arObj.container.css("margin-bottom").replace("px","")+"px","max-height":"none"}):a["container-max-height"]?r.arObj.container.css({height:"auto","max-height":a["container-max-height"]-1*r.arObj.container.css("margin-bottom").replace("px","")+"px"}):r.arObj.container.css({height:"auto","max-height":"none"}),r.arObj.container.removeClass("scrollpane-load")},e.func.scrollAreaTo=function(a,r,t,n,i){var o=!1;return"X"==t&&(a.arData.areaMarginX=r,r>0?(a.arData.areaMarginX=0,o=!0):r<a.arData.containerWidth-a.arData.areaWidth&&(a.arData.areaMarginX=a.arData.containerWidth-a.arData.areaWidth,o=!0),a.arData.containerWidth<a.arData.areaWidth?(a.arData.trackXMarginX=e.arData.lineXLeft-1*a.arData.areaMarginX*(a.arData.lineXWidth-a.arData.trackXWidth)/(a.arData.areaWidth-a.arData.containerWidth),n?(a.arObj.area.stop(),a.arObj.area.animate({"margin-left":a.arData.areaMarginX+"px","margin-right":-1*a.arData.areaMarginX+"px"},i),a.arObj.trackX.stop(),a.arObj.trackX.animate({"margin-left":a.arData.trackXMarginX+"px"},i)):(a.arObj.area.css({"margin-left":a.arData.areaMarginX+"px","margin-right":-1*a.arData.areaMarginX+"px"}),a.arObj.trackX.css({"margin-left":a.arData.trackXMarginX+"px"}))):(a.arObj.area.css({"margin-left":0,"margin-right":0}),a.arObj.trackX.css({"margin-left":e.arData.lineXLeft}))),"Y"==t&&(a.arData.areaMarginY=r,r>0?(a.arData.areaMarginY=0,o=!0):r<a.arData.containerHeight-a.arData.areaHeight&&(a.arData.areaMarginY=a.arData.containerHeight-a.arData.areaHeight,o=!0),a.arData.containerHeight<a.arData.areaHeight?(a.arData.trackYMarginY=e.arData.lineYTop-1*a.arData.areaMarginY*(a.arData.lineYHeight-a.arData.trackYHeight)/(a.arData.areaHeight-a.arData.containerHeight),n?(a.arObj.area.stop(),a.arObj.area.animate({"margin-top":a.arData.areaMarginY+"px","margin-bottom":-1*a.arData.areaMarginY+"px"},300),a.arObj.trackY.stop(),a.arObj.trackY.animate({"margin-top":a.arData.trackYMarginY+"px"},300)):(a.arObj.area.css({"margin-top":a.arData.areaMarginY+"px","margin-bottom":-1*a.arData.areaMarginY+"px"}),a.arObj.trackY.css({"margin-top":a.arData.trackYMarginY+"px"}))):(a.arObj.area.css({"margin-top":0,"margin-bottom":0}),a.arObj.trackY.css({"margin-top":e.arData.lineYTop}))),o},e.func.scrollTreckTo=function(a,r,t,n,i){"X"==t&&(a.arData.areaMarginX=-1*r*(a.arData.areaWidth-a.arData.containerWidth)/(a.arData.lineXWidth-a.arData.trackXWidth),e.func.scrollAreaTo(a,a.arData.areaMarginX,t,n,i)),"Y"==t&&(a.arData.areaMarginY=-1*r*(a.arData.areaHeight-a.arData.containerHeight)/(a.arData.lineYHeight-a.arData.trackYHeight),e.func.scrollAreaTo(a,a.arData.areaMarginY,t,n,i))},e.func.scrollBottom=function(){e.arData.containerGlobalTop=1*e.arObj.containerGlobal.offset().top;var a=1*$(document).scrollTop()+1*$(window).height();a<e.arData.containerGlobalTop+e.arData.containerGlobalHeight+e.arData.barXHeight&&a>e.arData.containerGlobalTop+e.arData.barXHeight+50?(e.arObj.barX.addClass("scrollpane-bar-x-bottom"),e.arObj.barX.css({left:e.arData.containerGlobalLeft+"px",width:e.arData.containerGlobalWidth+"px",bottom:e.trackXHeight/2+"px"})):(e.arObj.barX.removeClass("scrollpane-bar-x-bottom"),e.arObj.barX.attr("style",""),e.arObj.barX.prop("style",!1))},e.func.start=function(){e.arObj.area.data("scroll-bottom")&&(a["scroll-bottom"]=!0);var t="";t+=e.arObj.area.data("width")?"width: "+e.arObj.area.data("width")+"px; max-width: none;":e.arObj.area.data("max-width")?"width: auto; max-width: "+e.arObj.area.data("max-width")+"px;":a["container-width"]?"width: "+a["container-width"]+"px; max-width: none;":a["container-max-width"]?"width: auto; max-width: "+a["container-max-width"]+"px;":"width: auto; max-width: none;",t+=e.arObj.area.data("height")?"height: "+e.arObj.area.data("height")+"px; max-height: none;":e.arObj.area.data("max-height")?"height: auto; max-height: "+e.arObj.area.data("max-height")+"px;":a["container-height"]?"height: "+a["container-height"]+"px; max-height: none;":a["container-max-height"]?"height: auto; max-height: "+a["container-max-height"]+"px;":"height: auto; max-height: none;",t.length>0&&(t=' style="'+t+'"'),e.arObj.area.addClass("scrollpane-area"),e.arObj.area.wrap('<div class="scrollpane-container scrollpane-load" />'),e.arObj.container=e.arObj.area.parent(),e.arObj.container.wrap('<div class="scrollpane-container-global"'+t+" />"),e.arObj.containerGlobal=e.arObj.container.parent(),e.arObj.containerGlobal.append('<div class="scrollpane-bar-x" unselectable="on"><div class="scrollpane-line-x" unselectable="on"></div><div class="scrollpane-track-x" unselectable="on"></div></div>'),e.arObj.barX=e.arObj.containerGlobal.find("> .scrollpane-bar-x"),e.arObj.lineX=e.arObj.barX.find("> .scrollpane-line-x"),e.arObj.trackX=e.arObj.barX.find("> .scrollpane-track-x"),e.arData.trackXHeight=e.arObj.trackX.height(),e.arObj.containerGlobal.append('<div class="scrollpane-bar-y" unselectable="on"><div class="scrollpane-line-y" unselectable="on"></div><div class="scrollpane-track-y" unselectable="on"></div></div>'),e.arObj.barY=e.arObj.containerGlobal.find("> .scrollpane-bar-y"),e.arObj.lineY=e.arObj.barY.find("> .scrollpane-line-y"),e.arObj.trackY=e.arObj.barY.find("> .scrollpane-track-y"),e.arObj.area[0].addEventListener?"onwheel"in document?e.arObj.area[0].addEventListener("wheel",r):"onmousewheel"in document?e.arObj.area[0].addEventListener("mousewheel",r):e.arObj.area[0].addEventListener("MozMousePixelScroll",r):e.arObj.area[0].attachEvent("onmousewheel",r),("horizontal"==a.type||"auto"==a.type)&&(e.arObj.dragObjectX=!1,e.arObj.trackX.mousedown(function(a){1==a.which&&($("body").addClass("not-selected"),e.arObj.dragObjectX=this,e.arObj.dragStartX=1*a.pageX-1*e.arObj.barX.offset().left+1*e.arObj.lineX.offset().left,e.arObj.dragStartMarginX=1*$(this).css("margin-left").replace("px",""))}),e.arObj.trackX.on("touchstart",function(a){e.arObj.dragStartX=1*a.originalEvent.touches[0].pageX,e.arObj.dragStartMarginX=1*$(this).css("margin-left").replace("px","")}),e.arObj.trackX.on("touchmove",function(a){var r=e.arObj.dragStartMarginX-e.arObj.dragStartX+1*a.originalEvent.touches[0].pageX;return e.func.scrollTreckTo(e,r,"X",!1,0),!1})),("vertical"==a.type||"auto"==a.type)&&(e.arObj.dragObjectY=!1,e.arObj.trackY.mousedown(function(a){1==a.which&&($("body").addClass("not-selected"),e.arObj.dragObjectY=this,e.arObj.dragStartY=1*a.pageY-1*e.arObj.barY.offset().top+1*e.arObj.lineY.offset().top,e.arObj.dragStartMarginY=1*$(this).css("margin-top").replace("px",""))}),e.arObj.trackY.on("touchstart",function(a){e.arObj.dragStartY=1*a.originalEvent.touches[0].pageY,e.arObj.dragStartMarginY=1*$(this).css("margin-top").replace("px","")}),e.arObj.trackY.on("touchmove",function(a){var r=e.arObj.dragStartMarginY-e.arObj.dragStartY+1*a.originalEvent.touches[0].pageY;return e.func.scrollTreckTo(e,r,"Y",!1,0),!1})),$(document).mousemove(function(a){if(e.arObj.dragObjectX){var r=e.arObj.dragStartMarginX-e.arObj.dragStartX+a.pageX;e.func.scrollTreckTo(e,r,"X",!1,0)}else if(e.arObj.dragObjectY){var r=e.arObj.dragStartMarginY-e.arObj.dragStartY+a.pageY;e.func.scrollTreckTo(e,r,"Y",!1,0)}}),$(document).mouseup(function(){$("body").removeClass("not-selected"),e.arObj.dragObjectX=!1,e.arObj.dragObjectY=!1}),e.arObj.area.on("touchstart",function(a){e.arObj.dragStartX=1*a.originalEvent.touches[0].pageX,e.arObj.dragStartMarginX=e.arData.areaMarginX,e.arObj.dragStartY=1*a.originalEvent.touches[0].pageY,e.arObj.dragStartMarginY=e.arData.areaMarginY}),e.arObj.area.on("touchmove",function(a){if(!canNotScroll){var r=e.arObj.dragStartMarginX-e.arObj.dragStartX+1*a.originalEvent.touches[0].pageX,t=e.arObj.dragStartMarginY-e.arObj.dragStartY+1*a.originalEvent.touches[0].pageY;e.func.scrollAreaTo(e,r,"X",!1,0),e.func.scrollAreaTo(e,t,"Y",!1,0)}}),e.arObj.lineX.click(function(r){e.arData.trackXMarginX>r.offsetX?e.func.scrollTreckTo(e,1*r.offsetX,"X",!0,a["animate-time"]):e.arData.trackXMarginX+e.arData.trackXWidth<r.offsetX&&e.func.scrollTreckTo(e,1*r.offsetX-e.arData.trackXWidth,"X",!0,a["animate-time"])}),e.arObj.lineY.click(function(r){e.arData.trackYMarginY>r.offsetY?e.func.scrollTreckTo(e,1*r.offsetY,"Y",!0,a["animate-time"]):e.arData.trackYMarginY+e.arData.trackYHeight<r.offsetY&&e.func.scrollTreckTo(e,1*r.offsetY-e.arData.trackYHeight,"Y",!0,a["animate-time"])}),a.arrow&&(e.arObj.containerGlobal.addClass("scrollpane-arrow"),e.arObj.barX.append('<div class="scrollpane-arrow-left"></div><div class="scrollpane-arrow-right"></div>'),e.arObj.arrowLeft=e.arObj.barX.find("> .scrollpane-arrow-left"),e.arObj.arrowRight=e.arObj.barX.find("> .scrollpane-arrow-right"),e.arObj.barY.append('<div class="scrollpane-arrow-up"></div><div class="scrollpane-arrow-down"></div>'),e.arObj.arrowUp=e.arObj.barY.find("> .scrollpane-arrow-up"),e.arObj.arrowDown=e.arObj.barY.find("> .scrollpane-arrow-down"),e.arObj.arrowLeft.click(function(){var r=e.arData.areaMarginX+e.arData.containerWidth/4;e.func.scrollAreaTo(e,r,"X",!0,a["animate-time"])}),e.arObj.arrowRight.click(function(){var r=e.arData.areaMarginX-e.arData.containerWidth/4;e.func.scrollAreaTo(e,r,"X",!0,a["animate-time"])}),e.arObj.arrowUp.click(function(){var r=e.arData.areaMarginY+e.arData.containerHeight/4;e.func.scrollAreaTo(e,r,"Y",!0,a["animate-time"])}),e.arObj.arrowDown.click(function(){var r=e.arData.areaMarginY-e.arData.containerHeight/4;e.func.scrollAreaTo(e,r,"Y",!0,a["animate-time"])})),e.func.trackSize(e),e.func.scrollAreaTo(e,a["scroll-to-x"],"X",!1,0),e.arObj.area.data("scroll-to-selector")&&$(e.arObj.area.data("scroll-to-selector")).length&&(a["scroll-to-y"]=-1*$(e.arObj.area.data("scroll-to-selector")).position().top),e.func.scrollAreaTo(e,a["scroll-to-y"],"Y",!1,0),a["scroll-bottom"]?(e.func.scrollBottom(),$(window).resize(function(){e.func.trackSize(e),e.func.scrollBottom()}),$(window).scroll(function(){e.func.scrollBottom()})):$(window).resize(function(){e.func.trackSize(e)})},e.arObj.area=$(e);var n=e.arObj.area.find("img");n.length?$.when(indi.utils.preloadImage(n)).done(function(){e.func.start()}):e.func.start()}})):!1};